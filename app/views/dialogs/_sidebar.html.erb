<aside class="w-80 border-r border-gray-300 bg-gray-50 py-4 px-2">
  <div class="flex items-center justify-between mb-4">
    <%= image_tag "sign.svg", class: "w-8 h-8" %>    
  </div>

  <%= link_to dialog_path(:new), 
                class: "px-4 py-2 text-dark-gray-900 block mb-3" do %>
      <span class="flex items-center gap-1">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
        </svg>

        New Chat
      </span>
    <% end %>
  
  <div class="space-y-1">
    <% @dialogs.each do |dlg| %>
      <% first_user_message = dlg.messages.order(:created_at).find_by(role: :user) %>
      <% label = first_user_message&.content&.truncate(20) || "New chat" %>
      <div class="group px-4 py-3 rounded-lg hover:bg-gray-100 flex items-center justify-between <%= dlg == @dialog ? 'bg-gray-100 font-medium' : 'text-gray-700' %>">
        <%= link_to dialog_path(dlg), class: "flex-grow" do %>
          <span class="truncate"><%= label %></span>
        <% end %>
        <%= button_to dialog_path(dlg),
                    method: :delete,
                    class: "ml-2 p-1 rounded hover:bg-red-100 text-red-500 hover:text-red-700 opacity-0 group-hover:opacity-100 transition-opacity shrink-0",
                    form: { class: "inline-block" },
                    title: "Delete dialog",
                    data: { turbo_confirm: "Are you sure you want to delete this dialog?" } do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
          </svg>
        <% end %>
      </div>
    <% end %>
  </div>
</aside>
