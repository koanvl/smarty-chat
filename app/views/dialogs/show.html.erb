<%= turbo_stream_from "dialog_#{@dialog.id}" if @dialog %>

<div class="min-h-screen flex">
  <%= render "sidebar" %>

  <main class="flex-1 flex flex-col">
    <%= render "how_to_use" %>
    <% if @dialog %>

      <div class="flex-1 bg-white">
        <div id="messages" class="h-[calc(100vh-240px)] overflow-y-auto p-6 space-y-4">
          <div class="max-w-screen-md mx-auto">
            <%= render @messages %>
          </div>
        </div>
      </div>

      <div class="flex-1 flex items-end bg-white w-full p-6">
        <div class="w-full max-w-screen-md mx-auto">
          <%= form_with model: Message.new,
                        url: dialog_messages_path(@dialog),
                        class: "w-full -ml-2",
                        data: {
                          controller: "reset-form",
                          action: "turbo:submit-end->reset-form#reset"
                        } do |f| %>
            <div class="flex-1">
              <div class="relative">
                <%= f.text_area :content,
                              rows: 1,
                              class: "block resize-none p-2.5 pb-12 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-0 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white",
                              placeholder: "Type your message..." %>
              
                <%= f.button type: :submit,
                  class: "w-8 h-8 absolute bottom-2.5 right-2.5 bg-blue-600 p-2 text-white font-medium hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-200 transition duration-200 rounded-full flex items-center justify-between" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" 
                      fill="none" 
                      viewBox="0 0 24 24" 
                      stroke-width="1.5" 
                      stroke="currentColor" 
                      class="w-4 h-4">
                    <path stroke-linecap="round" 
                          stroke-linejoin="round" 
                          d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18" />
                  </svg>
                <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% else %>
      <div class="flex-1 flex items-center justify-center w-full max-w-screen-md mx-auto">
        <%= render "new_dialog_form" %>
      </div>
    <% end %>
  </main>
</div>